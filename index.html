<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mini Miro - Priorização Esforço x Impacto</title>
    <link rel="stylesheet" href="./styles.css">
  </head>
  <body>
    <header class="app-header">
      <div class="groupbar">Grupo: <span id="groupSummary">nenhum</span></div>
      <h1>Mini Miro - Priorização Esforço x Impacto <span id="visibleCountStep1" class="count-badge">0</span></h1>
      <div class="legend" aria-label="Legenda de estilos dos cards">
        <div class="legend-item"><span class="legend-dot legend--operacao legend--problema"></span><span>Operação + Problema</span></div>
        <div class="legend-item"><span class="legend-dot legend--operacao legend--oportunidade"></span><span>Operação + Oportunidade</span></div>
        <div class="legend-item"><span class="legend-dot legend--inovacao legend--problema"></span><span>Inovação + Problema</span></div>
        <div class="legend-item"><span class="legend-dot legend--inovacao legend--oportunidade"></span><span>Inovação + Oportunidade</span></div>
        <div class="legend-item"><span class="legend-dot legend--outros legend--problema"></span><span>Outros + Problema</span></div>
        <div class="legend-item"><span class="legend-dot legend--outros legend--oportunidade"></span><span>Outros + Oportunidade</span></div>
      </div>
      <div class="header-actions">
        <button id="openVoteOverlayBtn" type="button">Modo votação (urgência)</button>
      </div>
    </header>

    <section class="controls">
      <div class="control-group">
        <label for="csvFile">Carregar base.csv</label>
        <input type="file" id="csvFile" accept=".csv" />
      </div>

      <div class="control-group">
        <label for="abordagemFilter">Abordagem</label>
        <select id="abordagemFilter">
          <option value="all">Todas</option>
          <option value="Oportunidade">Oportunidade</option>
          <option value="Problema">Problema</option>
          <option value="Outros">Outros</option>
        </select>
      </div>

      <div class="control-group">
        <label for="escopoFilter">Escopo</label>
        <select id="escopoFilter">
          <option value="all">Todos</option>
          <option value="Inovação">Inovação</option>
          <option value="Operação">Operação</option>
          <option value="Outros">Outros</option>
        </select>
      </div>

      <div class="control-group">
        <label for="tipoEsforcoFilter">Tipo de esforço</label>
        <select id="tipoEsforcoFilter">
          <option value="all">Todos</option>
          <option value="-">-</option>
          <option value="Tarefa">Tarefa</option>
          <option value="Iniciativa">Iniciativa</option>
          <option value="Ideia">Ideia</option>
          <option value="Follow-up">Follow-up</option>
        </select>
      </div>

      <div class="control-group">
        <label for="principalFilter">Principal</label>
        <select id="principalFilter">
          <option value="all">Todos</option>
          <option value="Experiência">Experiência</option>
          <option value="Mercado">Mercado</option>
          <option value="Plataforma">Plataforma</option>
          <option value="Outros">Outros</option>
        </select>
      </div>

      <div class="control-group">
        <label for="esforcoTecnicoFilter">Esforço técnico (CSV)</label>
        <select id="esforcoTecnicoFilter">
          <option value="all">Todos</option>
          <option value="Baixo">Baixo</option>
          <option value="Médio">Médio</option>
          <option value="Alto">Alto</option>
          <option value="Sem">Sem classificação</option>
        </select>
      </div>

      <div class="control-group">
        <label for="urgenciaFilter">Urgência</label>
        <select id="urgenciaFilter">
          <option value="all">Todas</option>
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
        </select>
      </div>

      <div class="control-group">
        <label>Squad</label>
        <div class="dropdown" id="squadDropdown">
          <button id="squadDropdownBtn" type="button" class="dropdown-btn">Squad: Todos</button>
          <div id="squadDropdownPanel" class="dropdown-panel hidden" role="menu" aria-label="Selecionar squads"></div>
        </div>
      </div>

      <div class="control-group">
        <label>Grupos</label>
        <div class="dropdown" id="groupDropdown">
          <button id="groupDropdownBtn" type="button" class="dropdown-btn">Grupos: Todos</button>
          <div id="groupDropdownPanel" class="dropdown-panel hidden" role="menu" aria-label="Selecionar grupos">
            <div id="groupDropdownList"></div>
          </div>
        </div>
      </div>

      <div class="control-group">
        <label for="textFilter">Buscar</label>
        <input type="text" id="textFilter" placeholder="Filtrar Demanda e descrição..." />
      </div>

      <div class="control-group">
        <label for="relationsToggle">Ver relacionamentos</label>
        <input type="checkbox" id="relationsToggle" />
      </div>

      <div class="control-group">
        <button id="exportCsvBtn" type="button">Exportar CSV (com classificações)</button>
      </div>

      <div class="control-group">
        <button id="goStep2Btn" type="button">Ir para Etapa 2 (Planejamento Semanas)</button>
      </div>

      <div class="control-group">
        <button id="resetFiltersBtn" type="button">Resetar filtros</button>
      </div>
    </section>

    <main class="board-wrapper">
      <svg id="relationsOverlay" class="relations-overlay" aria-hidden="true"></svg>
      <section class="board" id="board">
        <!-- Column headers moved to bottom -->

        <!-- Row: Altíssimo impacto (top row) -->
        <div class="y-label">Altíssimo<div class="hint">+5MM</div></div>
        <div class="cell" data-impact="Altíssimo" data-effort="Baixo"></div>
        <div class="cell" data-impact="Altíssimo" data-effort="Médio"></div>
        <div class="cell" data-impact="Altíssimo" data-effort="Alto"></div>

        <!-- Row: Alto impacto -->
        <div class="y-label">Alto<div class="hint">+1MM</div></div>
        <div class="cell" data-impact="Alto" data-effort="Baixo"></div>
        <div class="cell" data-impact="Alto" data-effort="Médio"></div>
        <div class="cell" data-impact="Alto" data-effort="Alto"></div>

        <!-- Row: Médio impacto -->
        <div class="y-label">Médio<div class="hint">~500k a 1MM</div></div>
        <div class="cell" data-impact="Médio" data-effort="Baixo"></div>
        <div class="cell" data-impact="Médio" data-effort="Médio"></div>
        <div class="cell" data-impact="Médio" data-effort="Alto"></div>

        <!-- Row: Baixo impacto -->
        <div class="y-label">Baixo<div class="hint">~100k</div></div>
        <div class="cell" data-impact="Baixo" data-effort="Baixo"></div>
        <div class="cell" data-impact="Baixo" data-effort="Médio"></div>
        <div class="cell" data-impact="Baixo" data-effort="Alto"></div>

        <!-- Column headers (bottom) -->
        <div class="y-label empty"></div>
        <div class="x-header">Baixo<div class="hint">~15 a 30 dias</div></div>
        <div class="x-header">Médio<div class="hint">~31 a 90 dias</div></div>
        <div class="x-header">Alto<div class="hint">+100 dias</div></div>
      </section>

      <aside class="backlog" id="backlog" aria-label="Backlog (não classificados)">
        <div class="backlog-header">
          <h2>Backlog (não classificados)</h2>
          <p>Arraste para um quadrante para classificar</p>
        </div>
        <div class="backlog-list" id="backlogList"></div>
      </aside>
    </main>

    <footer class="app-footer">
      <small>Arraste os cards para classificar por Esforço (colunas) e Impacto (linhas).</small>
    </footer>

    <!-- Modal de Observação Complementar -->
    <div id="noteModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="noteModalTitle">
      <div class="modal-dialog">
        <div class="modal-header">
          <h3 id="noteModalTitle">Observação complementar</h3>
          <button id="noteCloseBtn" class="btn-close" aria-label="Fechar">×</button>
        </div>
        <div class="modal-body">
          <div class="modal-item-title" id="noteItemTitle"></div>
          <div class="modal-grid-two">
            <div class="modal-field">
              <label class="modal-label">Pai</label>
              <div class="dropdown" id="parentDropdown">
                <button id="parentDropdownBtn" type="button" class="dropdown-btn">Selecionar pai</button>
                <div id="parentDropdownPanel" class="dropdown-panel hidden" role="menu" aria-label="Selecionar pai">
                  <input id="parentDropdownSearch" type="text" class="dropdown-search" placeholder="Buscar demanda..." />
                  <div id="parentDropdownList" class="dropdown-list"></div>
                </div>
              </div>
            </div>
            <div class="modal-field">
              <label class="modal-label" for="noteTipoSel">Tipo de esforço</label>
              <select id="noteTipoSel">
                <option>Tarefa</option>
                <option>Iniciativa</option>
                <option>Ideia</option>
                <option>Follow-up</option>
              </select>
            </div>
          </div>
          <div class="modal-grid-two">
            <div class="modal-field">
              <label class="modal-label" for="noteUrgSel">Urgência</label>
              <select id="noteUrgSel">
                <option value="0">0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
              </select>
            </div>
            <div class="modal-field">
              <label class="modal-label" for="noteGroupInput">Grupo</label>
              <div class="dropdown" id="noteGroupDropdown">
                <input id="noteGroupInput" type="text" maxlength="60" placeholder="Nome do grupo (até 60 chars)" />
                <div id="noteGroupPanel" class="dropdown-panel hidden" role="menu" aria-label="Selecionar grupo">
                  <div id="noteGroupList" class="dropdown-list"></div>
                </div>
              </div>
            </div>
          </div>
          <textarea id="noteTextarea" rows="6" placeholder="Anotações do facilitador da dinâmica..."></textarea>
        </div>
        <div class="modal-footer">
          <button id="noteCancelBtn" type="button">Cancelar</button>
          <button id="noteSaveBtn" type="button">Salvar</button>
        </div>
      </div>
    </div>

    <!-- Modal de Observações adicionais (somente leitura) -->
    <div id="obsModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="obsModalTitle">
      <div class="modal-dialog">
        <div class="modal-header">
          <h3 id="obsModalTitle">Observações adicionais</h3>
          <button id="obsCloseBtn" class="btn-close" aria-label="Fechar">×</button>
        </div>
        <div class="modal-body">
          <div class="modal-item-title" id="obsItemTitle"></div>
          <div id="obsContent" class="obs-content"></div>
        </div>
        <div class="modal-footer">
          <button id="obsOkBtn" type="button">Ok</button>
        </div>
      </div>
    </div>

    <!-- Sheet lateral de detalhes -->
    <aside id="detailSheet" class="sheet hidden" aria-label="Detalhes da demanda">
      <div class="sheet-header">
        <strong id="sheetTitle">Detalhes</strong>
        <button id="sheetCloseBtn" class="btn-close" aria-label="Fechar">×</button>
      </div>
      <div class="sheet-body">
        <div class="sheet-row"><div class="sheet-label">Demanda descrição</div><div class="sheet-value" id="sheetDemandaDesc"></div></div>
        <div class="sheet-row"><div class="sheet-label">Observações adicionais</div><div class="sheet-value" id="sheetObsAdd"></div></div>
        <div class="sheet-row"><div class="sheet-label">Qual o tipo de escopo</div><div class="sheet-value"><select id="sheetEscopoSel"><option>Operação</option><option>Inovação</option><option>Outros</option></select></div></div>
        <div class="sheet-row"><div class="sheet-label">Qual o tipo de abordagem</div><div class="sheet-value"><select id="sheetAbordagemSel"><option>Oportunidade</option><option>Problema</option><option>Outros</option></select></div></div>
        <div class="sheet-row"><div class="sheet-label">Qual o impacto econômico que poderá trazer?</div><div class="sheet-value"><select id="sheetImpactoSel"><option>Baixo</option><option>Médio</option><option>Alto</option><option>Altíssimo</option></select></div></div>
        <div class="sheet-row"><div class="sheet-label">Esforço técnico para entregar em produção</div><div class="sheet-value"><select id="sheetEsforcoSel"><option>Baixo</option><option>Médio</option><option>Alto</option></select></div></div>
        <div class="sheet-row"><div class="sheet-label">Andamento</div><div class="sheet-value"><select id="sheetAndamentoSel"><option>Sim</option><option>Não</option></select></div></div>
        <div class="sheet-row"><div class="sheet-label">Progresso (%)</div><div class="sheet-value"><input id="sheetProgressoInput" type="number" min="0" max="100" step="1" placeholder="0 a 100" /></div></div>
        <div class="sheet-row"><div class="sheet-label">Tipo de esforço</div><div class="sheet-value"><select id="sheetTipoSel"><option>Tarefa</option><option>Iniciativa</option><option>Follow-up</option></select></div></div>
        <div class="sheet-row"><div class="sheet-label">Tipo de esforço</div><div class="sheet-value"><select id="sheetTipoSel"><option>Tarefa</option><option>Iniciativa</option><option>Ideia</option><option>Follow-up</option></select></div></div>
        <div class="sheet-row"><div class="sheet-label">Urgência</div><div class="sheet-value"><select id="sheetUrgSel"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div></div>
        <div class="sheet-row"><div class="sheet-label">Principal Impacto</div><div class="sheet-value" id="sheetPrincipalImpacto"></div></div>
        <div class="sheet-row"><div class="sheet-label">Relacionamentos</div>
          <div class="sheet-value">
            <input id="relSearch" type="text" placeholder="Buscar demanda..." />
            <div id="relList" class="rel-list"></div>
          </div>
        </div>
        <div class="sheet-row"><div class="sheet-label">Observação complementar</div><div class="sheet-value"><textarea id="sheetObservation" rows="4" placeholder="Anotações do facilitador da dinâmica..."></textarea></div></div>
      </div>
    </aside>

    <!-- Overlay de votação de urgência -->
    <div id="voteOverlay" class="vote-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="voteOverlayTitle">
      <div class="vote-overlay-bar">
        <h2 id="voteOverlayTitle">Votação de urgência <span id="voteCount"></span></h2>
        <div class="vote-cols-ctrl">
          <label for="voteColsSel">Cards por linha</label>
          <select id="voteColsSel">
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5" selected>5</option>
            <option value="6">6</option>
          </select>
        </div>
        <button id="closeVoteOverlayBtn" type="button">Fechar</button>
      </div>
      <div id="voteGrid" class="vote-grid"></div>
    </div>

    <script src="./app.js"></script>
  </body>
  </html>


